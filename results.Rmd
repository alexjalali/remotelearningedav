# Results

## Packages

```{r}
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(geojsonio)
library(sp)
library(tidytext)
#for pcp
library(hrbrthemes)
library(GGally)
library(viridis)
json_map <- geojson_read("https://raw.githubusercontent.com/alexjalali/remotelearningedav/main/School%20Districts.geojson", what = "sp")

df <- read.csv(file='./datasets/DataClean.csv')
df_total <- subset(df, Category == "total") #dataframe with just aggregates
```


## Plot from JSON

```{r}
plot(json_map, col = "grey")
```
## <span style="color:darksalmon"> Section 1: Remote Learning Preferences for different districts </span>
### <span style="color:darksalmon"> 1.Normal bar plot of remote learning preferences </span>
```{r}
library(wesanderson)

p1 <- ggplot(df_total, aes(PercentRemote)) +
  geom_histogram(binwidth = 2.5, boundary = 60,
                col = "navajowhite4",bins=10,fill="honeydew3")+
  xlab("% Remote")+
  ggtitle("Histogram of Percent of Students who Prefer Remote Learning per District")

p1
```


### <span style="color:darksalmon"> 2.Cleveland dot plot of remote learning preferences per district (Order by Highest to Lowest) </span>
```{r}
district_remover_per_reorder <- fct_reorder(as.character(df_total$District), df_total$PercentRemote, min)

p2 <- ggplot(df_total, aes(PercentRemote,district_remover_per_reorder)) +
  geom_point(color = "darksalmon") +
  xlab("% Remote")+
  ylab("District")+theme_linedraw()+
  ggtitle("Cleveland dot plot of Percent of Students who Prefer Remote Learning per District")
p2
```

## <span style="color:darksalmon"> Section 2: Comparing same category across different districts </span>
### <span style="color:darksalmon"> Cleveland dot plot showing gender vs. remote learning AND ELL vs. remote learning </span>

```{r}
gender_plot <- df%>%filter(DisaggregationCategory == "Gender")
district_remover_per_reorder2 <- fct_reorder(as.character(gender_plot$District), gender_plot$PercentRemote)

p3 <- ggplot(gender_plot, aes(PercentRemote,district_remover_per_reorder2)) +
  geom_point(aes(color =Category)) + geom_line(aes(group = District),alpha=0.3) +
  xlab("% Remote")+
  ylab("District")+theme_linedraw()+
  ggtitle("Cleveland dot plot of Percent showing gender vs. remote learning per District")
p3
```

```{r}
ELL_plot <- df%>%filter(DisaggregationCategory == "English Language Learner Status")
district_remover_per_reorder3 <- fct_reorder(as.character(ELL_plot$District), ELL_plot$PercentRemote)

p4 <- ggplot(ELL_plot, aes(PercentRemote,district_remover_per_reorder3)) +
  geom_point(aes(color=Category)) + geom_line(aes(group = District),alpha=0.3) +
  xlab("% Remote")+
  ylab("District")+theme_linedraw()+
  ggtitle("Cleveland dot plot of Percent showing ELL vs. remote learning per District")
p4
```

### <span style="color:darksalmon"> TWO Cleveland dot plot with facets showing ethnicity AND grade </span>

```{r fig.height=4 }

Ethnicity_plot <- df%>%filter(DisaggregationCategory == "Race or Ethnicity")

p5 <- ggplot(Ethnicity_plot, aes(x = reorder_within(District, PercentRemote, Category), y = PercentRemote)) +
    geom_point(color="darksalmon",stat = "identity") + scale_x_reordered() +
    facet_wrap(Category ~ ., ncol = 2, scales = "free_x", strip.position = "right", )+ylab("% Remote")+ xlab("District") + ggtitle("Cleveland dot plot of Percent with facets showing Race or Ethnicity")

p5
```
```{r fig.height=4 }

Grade_plot <- df%>%filter(DisaggregationCategory == "Grade Level")

p6 <- ggplot(Grade_plot, aes(x = reorder_within(District, PercentRemote, Category), y = PercentRemote)) +
    geom_point(color="darksalmon",stat = "identity") + scale_x_reordered() +
    facet_wrap(Category ~ ., ncol = 2, scales = "free_x", strip.position = "right")+ylab("% Remote")+ xlab("District") + ggtitle("Cleveland dot plot of Percent with facets showing Grade Label")

p6
```
### Parallel coordinates plot

```{r pcp}
#this isn't working i am going to work on this tomorrow
#highlight the clusters based on the Species column
pcpdf <- df_total %>% subset(select=c("ELAScores2019","ELAScores2022","MathScores2019","MathScores2022","remote_cat")) 

#highlight the clusters based on the remote categorical column
pcp<-ggparcoord(pcpdf, columns=1:4, groupColumn = 5, title = "Parallel Coordiantes Plot for average test scores per district, grouped by percent remote",scale = "globalminmax") 
pcp
```
### Parallel coordinates plot


```{r}

```
